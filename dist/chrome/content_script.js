!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=167)}({167:function(e,t){var n;!function(e){e.Login="login",e.Card="card",e.Search="search",e.ContactInfo="contactinfo",e.NewsLetter="newsletter",e.Register="register",e.Unknown="unknown"}(n||(n={}));const o=new Map([["username",{type:/text|email/,name:/user|name|mail/}],["password",{type:/password/,name:/.*/}],["cardno",{type:/text|tel/,name:/card/}],["expires",{type:/text|tel/,name:/exp/}],["cvc",{type:/text|tel/,name:/sec|code|cvv|cvc/}]]),r=new Map([[n.Search,{name:/search/,role:/search/,fields:[{type:/text|search/,name:/search/}]}],[n.Register,{name:/reg|signup/,fields:[{type:/password/,name:/re/}]}],[n.Login,{name:/login/,fields:[o.get("username"),o.get("password")]}],[n.NewsLetter,{name:/news|letter/,fields:[]}]]);function s(e,t){if(void 0===o.get(e))return!1;const n=new RegExp(o.get(e).type,"i"),r=new RegExp(o.get(e).name,"i");return n.test(t.type)&&(r.test(t.name)||r.test(t.id))}function l(e){for(const[t,n]of r){const o=new RegExp(n.name,"i");if(o.test(e.id)||o.test(e.name))return t;const r=e.attributes.getNamedItem("role");if(n.role&&r){if(new RegExp(n.role,"i").test(r.value))return t}let s=0!==n.fields.length;for(let t=0;t<n.fields.length;t++){const o=new RegExp(n.fields[t].name,"i"),r=new RegExp(n.fields[t].type,"i");let l=!1;for(let t=0;t<e.length;t++){const n=e[t];(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement||n instanceof HTMLSelectElement)&&r.test(n.type)&&(o.test(n.id)||o.test(n.name))&&(l=!0)}s=s&&l}if(s)return t}return n.Unknown}const i=[n.Login,n.Card],a=[n.Login,n.Register];let c=[];function u(){const{forms:e}=document;c=[];for(let t=0;t<e.length;t++){const n=l(e[t]);console.log(n,e[t]),i.includes(n)&&(console.log("Adding form to fillable: ",e[t]),c.push(e[t])),a.includes(n)&&(console.log("Attaching submit handler to: ",e[t]),e[t].addEventListener("submit",e=>{const t=new Map,n=e.target;for(const[e]of o)for(let o=0;o<n.length;o++){const r=n[o];r instanceof HTMLInputElement&&s(e,r)&&(console.log(e,r.value),t.set(e,r.value))}browser.runtime.sendMessage({type:"submit",values:Array.from(t)})}))}c.length>0&&browser.runtime.sendMessage({type:"tabSearch"})}u();new MutationObserver((e,t)=>{console.log(e,t),u()}).observe(document.body,{childList:!0}),browser.runtime.onMessage.addListener((function(e){if("fill"===e.type){console.log(e.data);for(let t=0;t<c.length;t++){let n=!1;for(let o=0;o<c[t].length;o++){const r=c[t][o];if(r instanceof HTMLInputElement){let t=!1;Object.keys(e.data).forEach(o=>{if(console.log("Attempting to fill",o,"in",r),s(o,r))return console.log("Filled field",o),t=!0,n=!0,void(r.value=e.data[o])}),t||["hidden","button","submit","reset"].includes(r.type)||(console.log("Focus unfilled element",r),r.focus())}}}}}))}});
//# sourceMappingURL=content_script.js.map