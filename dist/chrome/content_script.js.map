{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/content_script.ts"],"names":[],"mappings":"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","file":"content_script.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/content_script.ts\");\n","// const types = /text|url|password|email/i;\n// const ids = /user|name|pass|mail|url|server|site/i;\n\nenum FormType {\n  Login = 'login',\n  Card = 'card',\n  Search = 'search',\n  ContactInfo = 'contactinfo',\n  NewsLetter = 'newsletter',\n  Register = 'register',\n  Unknown = 'unknown',\n}\n\ninterface Matcher {\n  type: RegExp;\n  name: RegExp;\n}\n\ninterface FormMatcher {\n  name: RegExp;\n  role?: RegExp;\n  fields: Matcher[];\n}\n\n/**\n * Keys should match field names in StoredSafe, form inputs should only be filled\n * with the corresponding StoredSafe data if both type and name (name or id attribute)\n * get a match.\n * */\nconst matchers: Map<string, Matcher> = new Map([\n  ['username', {\n    type: /text|email/,\n    name: /user|name|mail/,\n  }],\n  ['password', {\n    type: /password/,\n    name: /.*/,\n  }],\n  ['cardno', {\n    type: /text|tel/,\n    name: /card/,\n  }],\n  ['expires', {\n    type: /text|tel/,\n    name: /exp/,\n  }],\n  ['cvc', {\n    type: /text|tel/,\n    name: /sec|code|cvv|cvc/,\n  }],\n]);\n\n/**\n * Matching the form name is considered a definite match and should return the form type,\n * not matching a name means the fields fallback should be checked.\n * If using the fields fallback, the form should only be considered a match if all fields\n * matchers find a match.\n * The formMatchers will be checked in order of appearance and the first match if any will\n * be used, meaning more generic matchers should be placed further down in the list.\n * */\nconst formMatchers: Map<FormType, FormMatcher> = new Map([\n  [FormType.Search, {\n    name: /search/,\n    role: /search/,\n    fields: [{\n      type: /text|search/,\n      name: /search/,\n    }],\n  }],\n  [FormType.Register, {\n    name: /reg|signup/,\n    fields: [{\n      type: /password/,\n      name: /re/,\n    }],\n  }],\n  [FormType.Login, {\n    name: /login/,\n    fields: [\n      matchers.get('username'),\n      matchers.get('password'),\n    ],\n  }],\n  [FormType.NewsLetter, {\n    name: /news|letter/,\n    fields: [],\n  }],\n]);\n\nfunction isMatch(\n  field: string,\n  element: HTMLInputElement\n): boolean {\n  if (matchers.get(field) === undefined) return false;\n  const types = new RegExp(matchers.get(field).type, 'i');\n  const name = new RegExp(matchers.get(field).name, 'i');\n  return (\n    types.test(element.type) && ( name.test(element.name) || name.test(element.id))\n  );\n}\n\nfunction isElementFillable(element: Element): boolean {\n  return element instanceof HTMLInputElement && ![\n    'hidden',\n    'button',\n    'submit',\n    'reset'\n  ].includes(element.type);\n}\n\nfunction getFormType(form: HTMLFormElement): FormType {\n  for(const [formType, formTypeMatchers] of formMatchers) {\n\n    // Check for form name or id match\n    const name = new RegExp(formTypeMatchers.name, 'i');\n    if (name.test(form.id) || name.test(form.name)) {\n      return formType;\n    }\n\n    // Check for form role\n    const formRole = form.attributes.getNamedItem('role');\n    if (formTypeMatchers.role && formRole) {\n      const role = new RegExp(formTypeMatchers.role, 'i');\n      if (role.test(formRole.value)) {\n        return formType;\n      }\n    }\n\n    // Check for fields match\n    let match = formTypeMatchers.fields.length === 0 ? false : true;\n    for(let i = 0; i < formTypeMatchers.fields.length; i++) {\n      const fieldName = new RegExp(formTypeMatchers.fields[i].name, 'i');\n      const fieldType = new RegExp(formTypeMatchers.fields[i].type, 'i');\n      let fieldMatch = false;\n      for(let j = 0; j < form.length; j++) {\n        const element = form[j];\n        if (element instanceof HTMLInputElement || element instanceof HTMLTextAreaElement || element instanceof HTMLSelectElement) {\n          if (fieldType.test(element.type) && (fieldName.test(element.id) || fieldName.test(element.name))) {\n            fieldMatch = true;\n          }\n        }\n      }\n      // Overall match only if all fields find a matching element.\n      match = match && fieldMatch;\n    }\n    if (match) return formType;\n  }\n  return FormType.Unknown;\n}\n\nconst fillFormTypes: FormType[] = [\n  FormType.Login,\n  FormType.Card,\n];\n\nconst saveFormTypes: FormType[] = [\n  FormType.Login,\n  FormType.Register,\n];\n\nlet fillForms: HTMLFormElement[] = [];\nfunction setup(): void {\n  const { forms } = document;\n  fillForms = [];\n  for(let i = 0; i < forms.length; i++) {\n    const formType = getFormType(forms[i]);\n    console.log(formType, forms[i]);\n    if (fillFormTypes.includes(formType)) {\n      console.log('Adding form to fillable: ', forms[i]);\n      fillForms.push(forms[i]);\n    }\n    if (saveFormTypes.includes(formType)) {\n      console.log('Attaching submit handler to: ', forms[i]);\n      forms[i].addEventListener('submit', (event) => {\n        const values: Map<string, string> = new Map();\n        const target = event.target as HTMLFormElement;\n        for (const [field] of matchers) {\n          for (let i = 0; i < target.length; i++) {\n            const element = target[i];\n            if (element instanceof HTMLInputElement && isMatch(field, element)) {\n              console.log(field, element.value);\n              values.set(field, element.value);\n            }\n          }\n        }\n        browser.runtime.sendMessage({ type: 'submit', values: Array.from(values) })\n      });\n    }\n  }\n\n  if (fillForms.length > 0) {\n    browser.runtime.sendMessage({\n      type: 'tabSearch',\n    });\n  }\n}\n\nsetup();\nconst observer = new MutationObserver((m, o) => { console.log(m, o); setup() });\nobserver.observe(document.body, { childList: true });\n\ninterface Message {\n  type: string;\n  data: [string, string][];\n}\n\nfunction onMessage(\n  message: Message,\n): void {\n  if (message.type === 'fill') {\n    console.log(message.data);\n    for (const form of fillForms) {\n      let filled = false;\n      for (const element of form) {\n        if (element instanceof HTMLInputElement && isElementFillable(element)) {\n          let elementFilled = false;\n          for (const [field, value] of new Map(message.data)) {\n            console.log('Attempting to fill', field, 'in', element);\n            if (isMatch(field, element)) {\n              console.log('Filled field', field);\n              elementFilled = true;\n              filled = true;\n              element.value = value;\n              break;\n            }\n          }\n          if (!elementFilled) { // If no field matched this element\n            console.log('Focus unfilled element', element);\n            element.focus(); // Focus element for easier access (example otp field)\n          }\n        }\n      }\n      if (filled) {\n        // fillForms[i].submit(); // TODO: Fix compatibility with autofill on failed login.\n      }\n    }\n  }\n}\n\nbrowser.runtime.onMessage.addListener(onMessage);\n"],"sourceRoot":""}